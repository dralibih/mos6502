#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

#include "addressing_modes.h"
#include "fetch_cycle.h"
#include "execute_cycle.h"
#include "instruction_set.h"
#include "mos6502_utils.h"

int main()
{
    Mos6502 cpu;
    Memory mem;

    init_memory(&mem);

    reset_cpu(&cpu, &mem);

    printf("INITIAL PC: 0x%04x \n\n", cpu.pc);
    for(int i=0; i<100; i++) printf("=");
    printf("\n");

    mem.ram[0x0600] = 0xa0;
    mem.ram[0x0601] = 0x00;
    mem.ram[0x0602] = 0xb1;
    mem.ram[0x0603] = 0x30;
    mem.ram[0x0604] = 0xaa;
    mem.ram[0x0605] = 0xa5;
    mem.ram[0x0606] = 0x2f;
    mem.ram[0x0607] = 0xc8;
    mem.ram[0x0608] = 0xd1;
    mem.ram[0x0609] = 0x30;
    mem.ram[0x060A] = 0xf0;
    mem.ram[0x060B] = 0x04;
    mem.ram[0x060C] = 0xca;
    mem.ram[0x060D] = 0xd0;
    mem.ram[0x060E] = 0xf8;
    mem.ram[0x060F] = 0x60;
    mem.ram[0x0610] = 0xca;
    mem.ram[0x0611] = 0xf0;
    mem.ram[0x0612] = 0x0a;
    mem.ram[0x0613] = 0xc8;
    mem.ram[0x0614] = 0xb1;
    mem.ram[0x0615] = 0x30;
    mem.ram[0x0616] = 0x88;
    mem.ram[0x0617] = 0x91;
    mem.ram[0x0618] = 0x30;
    mem.ram[0x0619] = 0xc8;
    mem.ram[0x061A] = 0x4c;
    mem.ram[0x061B] = 0x10;
    mem.ram[0x061C] = 0x06;
    mem.ram[0x061D] = 0xa1;
    mem.ram[0x061E] = 0x30;
    mem.ram[0x060F] = 0xe9;
    mem.ram[0x0620] = 0x01;
    mem.ram[0x0621] = 0x81;
    mem.ram[0x0622] = 0x30;
    mem.ram[0x0623] = 0x60;

    execute_program(&cpu, &mem);
}
